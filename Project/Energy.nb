(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     27618,        796]
NotebookOptionsPosition[     25847,        732]
NotebookOutlinePosition[     26203,        748]
CellTagsIndexPosition[     26160,        745]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"W", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "2", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "3", ",", "5"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3", ",", "0", ",", "6"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "5", ",", "6", ",", "0"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.5498226368661013`*^9, 3.549822679255054*^9}, {
  3.549823026497425*^9, 3.549823046879643*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "3", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "0", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5", ",", "6", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.5498226574527903`*^9, 3.549822679671035*^9}, {
   3.549823028655612*^9, 3.5498230475564127`*^9}, 3.549824309205868*^9, 
   3.549824854346961*^9, 3.54983680101088*^9, 3.5498412479215097`*^9, 
   3.549841388842251*^9, 3.5498923939549427`*^9, 3.549893417620118*^9, 
   3.54990612903273*^9, 3.549906573234209*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"state", " ", "=", " ", 
  RowBox[{"RandomInteger", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "4"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.549822695876648*^9, 3.5498227126054907`*^9}, {
  3.5498228142877693`*^9, 3.549822874016095*^9}, {3.549822909463016*^9, 
  3.549822924887555*^9}, {3.5498230076446753`*^9, 3.549823009481989*^9}, {
  3.5498375041861897`*^9, 3.549837505416154*^9}, {3.549838169425521*^9, 
  3.549838170824995*^9}, {3.549838434618988*^9, 3.5498384350898046`*^9}, {
  3.5498927098562107`*^9, 3.54989271096342*^9}, {3.549905178561183*^9, 
  3.549905182807056*^9}, {3.5499054244695997`*^9, 3.5499054316902933`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1"}], ",", "0", ",", 
   RowBox[{"-", "1"}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.549825065134755*^9, {3.549825165174842*^9, 3.549825171200264*^9}, 
   3.54983680353189*^9, 3.549837506127034*^9, 3.549837861188026*^9, 
   3.549837936174855*^9, 3.549838031457851*^9, 3.5498382814867*^9, 
   3.549838444881942*^9, 3.549841248636189*^9, 3.5498413893427343`*^9, 
   3.5498923948574657`*^9, {3.549892707401342*^9, 3.5498927116085463`*^9}, 
   3.549893417722415*^9, 3.549905183579492*^9, {3.54990541657174*^9, 
   3.549905426753355*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"theta", " ", "=", " ", 
  RowBox[{"RandomReal", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "100"}], "}"}], ",", "4"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.549822951842285*^9, 3.549822973935424*^9}, {
   3.549823019017705*^9, 3.54982301973711*^9}, {3.549838450417111*^9, 
   3.549838454920282*^9}, 3.54990708747393*^9, 3.549907425443612*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.38908955087833164`", ",", "2.1751515437565523`", ",", 
   "7.210805603304351`", ",", "2.0130959146845573`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.5498229745334*^9, 3.54982302010043*^9, 3.549824319366001*^9, 
   3.549824861394038*^9, {3.549838451573567*^9, 3.549838455248357*^9}, 
   3.5498412491205807`*^9, 3.549841389760592*^9, 3.5498923960238953`*^9, 
   3.5498934178893843`*^9, 3.549906131498598*^9, 3.549906577475048*^9, 
   3.54990708854634*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"state", ".", "W", ".", "state"}]], "Input",
 CellChangeTimes->{{3.549892627648705*^9, 3.549892630947815*^9}, {
  3.549892674338636*^9, 3.549892676392797*^9}, {3.549892723212145*^9, 
  3.549892743703891*^9}}],

Cell[BoxData["12"], "Output",
 CellChangeTimes->{
  3.549892631815001*^9, 3.549892677034521*^9, {3.5498927239451447`*^9, 
   3.549892744174665*^9}, 3.549893418338354*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Energy", "[", 
      RowBox[{"w_", ",", "\[Theta]_"}], "]"}], "[", "s_", "]"}], " ", ":=", 
    " ", 
    RowBox[{
     RowBox[{"\[Theta]", " ", ".", " ", "s"}], " ", "-", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"s", " ", ".", " ", "w", ".", " ", "s"}], "/", "2"}], 
      ")"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpdateState", "[", 
    RowBox[{"w_", ",", "\[Theta]_"}], "]"}], "[", "s_", "]"}], ":=", " ", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s2", " ", "=", " ", 
      RowBox[{"MapAt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"1", "-", "#"}], "&"}], ",", " ", "s", ",", " ", 
        RowBox[{"RandomInteger", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"Length", "[", "s", "]"}]}], "}"}], "]"}]}], "]"}]}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Energy", "[", 
         RowBox[{"w", ",", "\[Theta]"}], "]"}], "[", "s2", "]"}], "<", 
       RowBox[{
        RowBox[{"Energy", "[", 
         RowBox[{"w", ",", "\[Theta]"}], "]"}], "[", "s", "]"}]}], ",", "s2", 
      ",", "s"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.5498386946471643`*^9, 3.5498388337089987`*^9}, {
  3.549838873596439*^9, 3.549838879373509*^9}, {3.5498389442080517`*^9, 
  3.549839021374443*^9}, {3.549892793695052*^9, 3.549892816810081*^9}, {
  3.549906210758288*^9, 3.549906214445669*^9}, {3.549906306881607*^9, 
  3.549906309008993*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"graycode", "[", "n_", "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"IntegerDigits", "[", 
       RowBox[{"#", ",", "2", ",", "n"}], "]"}], "&"}], ",", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"BitXor", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Floor", "[", 
           RowBox[{"#", "/", "2"}], "]"}]}], "]"}], "&"}], ",", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"2", "^", "n"}], "-", "1"}]}], "]"}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{
  3.549905198809629*^9, {3.549905551045363*^9, 3.549905646863255*^9}, {
   3.549905683027726*^9, 3.549905692354302*^9}, {3.549905747161862*^9, 
   3.549905905200124*^9}, {3.5499059446616707`*^9, 3.549906051326116*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"neg", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"2", "*", "n"}], "-", "1"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"graycodeneg1", "[", "l_", "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{"neg", ",", "l"}], "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.5499060560152273`*^9, 3.5499060668708763`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graycodeneg", "[", "n_", "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{"graycodeneg1", ",", 
    RowBox[{"graycode", "[", "n", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.549906080845107*^9, 3.549906107306275*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ArrayPlot", "[", 
  RowBox[{"NestList", "[", 
   RowBox[{
    RowBox[{"UpdateState", "[", 
     RowBox[{"W", ",", "theta"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", "100"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.549839060595584*^9, 3.549839245761149*^9}, {
  3.549841108664054*^9, 3.5498411516942883`*^9}, {3.549841219360056*^9, 
  3.5498412367345047`*^9}, {3.54989296217916*^9, 3.549892975729416*^9}, {
  3.549906442933481*^9, 3.549906494104308*^9}}],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJxTTMoPSmJiYGBIBWIWhlFAL8CIDzOiYgBhagIh
   "], {{0, 0}, {4, 101}}, {0, 1}],
  
  Frame->Automatic,
  FrameLabel->{None, None},
  FrameTicks->{{None, None}, {None, None}}]], "Output",
 CellChangeTimes->{{3.549841239360983*^9, 3.549841250134605*^9}, 
   3.54984139123013*^9, {3.549892401684247*^9, 3.549892414953834*^9}, 
   3.549892845483777*^9, {3.5498929646233377`*^9, 3.549892984992496*^9}, 
   3.549893419924447*^9, 3.5498992886616*^9, 3.5499061550183496`*^9, 
   3.549906219842785*^9, {3.5499064435986757`*^9, 3.549906503677524*^9}}]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.5499064619993258`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"graycode", "[", "4", "]"}]], "Input",
 CellChangeTimes->{{3.54989932733079*^9, 3.549899336318986*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.5498993368081827`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{"W", ",", "theta"}], "]"}]], "Input",
 CellChangeTimes->{{3.5498993330724688`*^9, 3.54989933410246*^9}, {
  3.549906350599286*^9, 3.549906377717669*^9}, {3.5499065655287247`*^9, 
  3.5499065694476967`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"boa", "[", 
   RowBox[{"w_", ",", "\[Theta]_"}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Nest", "[", 
      RowBox[{
       RowBox[{"UpdateState", "[", 
        RowBox[{"w", ",", "\[Theta]"}], "]"}], ",", "#", ",", "100"}], "]"}], 
     "&"}], ",", 
    RowBox[{"graycode", "[", "4", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5498413167349453`*^9, 3.549841593054592*^9}, {
  3.549841649875173*^9, 3.549841683828259*^9}, {3.54984202738592*^9, 
  3.549842027468443*^9}, {3.549892377883581*^9, 3.549892385401979*^9}, {
  3.549892441458733*^9, 3.5498924421689034`*^9}, {3.549893211664114*^9, 
  3.549893216652547*^9}, {3.549906162343803*^9, 3.5499061626380863`*^9}, {
  3.549906323508924*^9, 3.5499063241563797`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ArrayPlot", "[", 
  RowBox[{"boa", "[", 
   RowBox[{"W", ",", "theta"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.54989286477328*^9, 3.549892889160996*^9}, {
  3.5498930507771893`*^9, 3.549893101300145*^9}}],

Cell[BoxData[
 GraphicsBox[
  RasterBox[{{0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0,
    0}, {0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0, 
   0}, {0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0, 0}, {
   1, 1, 1, 1}}, {{0, 0}, {4, 16}}, {0, 1}],
  Frame->Automatic,
  FrameLabel->{None, None},
  FrameTicks->{{None, None}, {None, None}}]], "Output",
 CellChangeTimes->{{3.549892870183611*^9, 3.549892910234496*^9}, 
   3.549893058892654*^9, {3.549893092683243*^9, 3.549893101985552*^9}, 
   3.5498934242833242`*^9, 3.5499061700214167`*^9, 3.549906227328727*^9, 
   3.549906327304888*^9, {3.549906366629868*^9, 3.549906379751885*^9}, 
   3.549906516702695*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"boa1", "[", 
   RowBox[{"w_", ",", "\[Theta]_", ",", "n_", ",", "state_"}], "]"}], ":=", 
  RowBox[{"Nest", "[", 
   RowBox[{
    RowBox[{"UpdateState", "[", 
     RowBox[{"w", ",", "\[Theta]"}], "]"}], ",", "state", ",", "200"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.54989327655896*^9, 3.549893361062585*^9}, 
   3.549893413425969*^9, {3.549893454594795*^9, 3.5498934580002413`*^9}, {
   3.549893843296763*^9, 3.549893846398823*^9}, {3.549894302490468*^9, 
   3.549894303593375*^9}, {3.549900096997654*^9, 3.549900098413438*^9}, {
   3.54990718078017*^9, 3.549907183251493*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"boa2", "[", 
    RowBox[{"w_", ",", "\[Theta]_", ",", "n_"}], "]"}], "[", "state_", "]"}], 
  " ", ":=", 
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"boa1", "[", 
      RowBox[{"w", ",", "\[Theta]", ",", "n", ",", "state"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "100"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.549893430450391*^9, 3.549893438469701*^9}, {
   3.549893470734337*^9, 3.549893521262967*^9}, {3.549893588963161*^9, 
   3.549893788596961*^9}, {3.549893838225306*^9, 3.549893840104672*^9}, {
   3.5498939029536963`*^9, 3.549893909880439*^9}, {3.549893987216754*^9, 
   3.549893993031739*^9}, {3.549894221823031*^9, 3.549894272012733*^9}, {
   3.549894307730013*^9, 3.549894337482793*^9}, {3.549894450421565*^9, 
   3.5498944813519382`*^9}, {3.5498945152609463`*^9, 3.549894545875514*^9}, {
   3.549894593286858*^9, 3.549894596957788*^9}, {3.5498946315219393`*^9, 
   3.549894641642745*^9}, 3.549894688726574*^9, 3.549894761258602*^9, {
   3.549894824564451*^9, 3.549894826042779*^9}, {3.549900102172868*^9, 
   3.549900106493145*^9}, {3.549906615647184*^9, 3.5499066159029303`*^9}, {
   3.549907186835857*^9, 3.549907187203353*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"boa3", "[", 
   RowBox[{"w_", ",", "\[Theta]_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"boa2", "[", 
        RowBox[{"w", ",", "\[Theta]", ",", "n"}], "]"}], "[", "#", "]"}], ",",
       "#"}], "}"}], "&"}], "/@", 
   RowBox[{"graycode", "[", "n", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.549893796262844*^9, 3.5498938884677687`*^9}, {
  3.549894073139778*^9, 3.5498940937194843`*^9}, {3.549894890066383*^9, 
  3.549894953882289*^9}, {3.549900076187912*^9, 3.549900092798635*^9}, {
  3.549906606782642*^9, 3.549906608925908*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"boa3", "[", 
  RowBox[{"W", ",", "theta", ",", "4"}], "]"}]], "Input",
 CellChangeTimes->{{3.549894698489872*^9, 3.549894700794541*^9}, {
  3.549906593693955*^9, 3.5499065941093893`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.549894711238167*^9, 3.54989479908526*^9, 3.549894830191242*^9, 
   3.549894959161407*^9, 3.549906235980051*^9, 3.549906337631263*^9, {
   3.549906372898057*^9, 3.5499063836493073`*^9}, 3.549906545042643*^9, {
   3.5499065858357058`*^9, 3.549906623652444*^9}, 3.549906670256175*^9, 
   3.549907097060072*^9, 3.5499071970037317`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ArrayPlot", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.54989474307707*^9, 3.5498947473852043`*^9}}],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJxTTMoPSmVmYGAQAGImIAaxIeCBPQNWMCo+Kj68xQEJGCWi
   "], {{0, 0}, {2, 16}}, {
   0, 1}],
  Frame->Automatic,
  FrameLabel->{None, None},
  FrameTicks->{{None, None}, {None, None}}]], "Output",
 CellChangeTimes->{
  3.549894747762311*^9, {3.5498948193076353`*^9, 3.5498948313753366`*^9}, 
   3.549906644313483*^9, 3.549907101813086*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"meanboa", "[", "l_", "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ReplacePart", "[", 
      RowBox[{"#", ",", 
       RowBox[{"1", "\[Rule]", 
        RowBox[{"Mean", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], "]"}], "&"}], ",", "l"}],
    "]"}]}]], "Input",
 CellChangeTimes->{{3.549895176547655*^9, 3.549895286700925*^9}, {
  3.549895323938628*^9, 3.5498953575555687`*^9}, {3.549895484335472*^9, 
  3.549895534676931*^9}, {3.549895570698393*^9, 3.549895613111829*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"meanboa", "[", 
  RowBox[{"boa3", "[", 
   RowBox[{"W", ",", "theta", ",", "4"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.549895290612731*^9, 3.549895299202804*^9}, {
  3.549906687255989*^9, 3.549906687888049*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", "2"], ",", 
       FractionBox["1", "2"], ",", 
       FractionBox["1", "2"], ",", 
       FractionBox["1", "2"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", "2"], ",", 
       FractionBox["1", "2"], ",", 
       FractionBox["1", "2"], ",", 
       FractionBox["1", "2"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", "2"], ",", 
       FractionBox["1", "2"], ",", 
       FractionBox["1", "2"], ",", 
       FractionBox["1", "2"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", "2"], ",", 
       FractionBox["1", "2"], ",", 
       FractionBox["1", "2"], ",", 
       FractionBox["1", "2"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.5498953018496227`*^9, 3.5498953288746758`*^9}, 
   3.549895362155385*^9, 3.5498954230022383`*^9, {3.549895489978386*^9, 
   3.549895538507373*^9}, {3.549895596549251*^9, 3.54989561665187*^9}, 
   3.549906651994255*^9, 3.549906691984346*^9}]
}, Open  ]]
},
WindowSize->{819, 752},
WindowMargins->{{-17, Automatic}, {Automatic, 24}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 5, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 522, 13, 27, "Input"],
Cell[1104, 37, 701, 15, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1842, 57, 660, 11, 27, "Input"],
Cell[2505, 70, 604, 12, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3146, 87, 385, 8, 27, "Input"],
Cell[3534, 97, 501, 10, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4072, 112, 231, 4, 27, "Input"],
Cell[4306, 118, 170, 3, 27, "Output"]
}, Open  ]],
Cell[4491, 124, 1668, 46, 88, "Input"],
Cell[6162, 172, 875, 24, 43, "Input"],
Cell[7040, 198, 370, 9, 58, "Input"],
Cell[7413, 209, 257, 6, 27, "Input"],
Cell[CellGroupData[{
Cell[7695, 219, 539, 12, 27, "Input"],
Cell[8237, 233, 594, 12, 447, "Output"]
}, Open  ]],
Cell[8846, 248, 89, 1, 43, "Input"],
Cell[CellGroupData[{
Cell[8960, 253, 126, 2, 27, "Input"],
Cell[9089, 257, 1361, 35, 43, "Output"]
}, Open  ]],
Cell[10465, 295, 257, 5, 27, "Input"],
Cell[10725, 302, 792, 18, 27, "Input"],
Cell[CellGroupData[{
Cell[11542, 324, 236, 5, 27, "Input"],
Cell[11781, 331, 719, 13, 447, "Output"]
}, Open  ]],
Cell[12515, 347, 622, 13, 27, "Input"],
Cell[13140, 362, 1270, 24, 27, "Input"],
Cell[14413, 388, 644, 16, 27, "Input"],
Cell[CellGroupData[{
Cell[15082, 408, 211, 4, 27, "Input"],
Cell[15296, 414, 5094, 148, 118, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20427, 567, 129, 2, 27, "Input"],
Cell[20559, 571, 390, 10, 447, "Output"]
}, Open  ]],
Cell[20964, 584, 580, 15, 27, "Input"],
Cell[CellGroupData[{
Cell[21569, 603, 244, 5, 27, "Input"],
Cell[21816, 610, 4015, 119, 183, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
